<!doctype html>
<html lang="kk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ö–æ–º–∏–∫—Å—Ç–µ—Ä</title>
  <link rel="stylesheet" href="assets/styles.css" />
</head>
<body>
  <div class="container">
    <nav class="nav">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>–ö–æ–º–∏–∫—Å—Ç–µ—Ä</h1>
          <p>–ö–æ–º–∏–∫—Å—Ç—ñ –æ—Å—ã —Å–∞–π—Ç—Ç–∞ “õ–∞—Ä–∞–ø, —Ç–∞–ø—Å—ã—Ä–º–∞ –æ—Ä—ã–Ω–¥–∞</p>
        </div>
      </div>
      <div class="nav-links">
        <a class="chip" href="index.html">–ë–∞—Å—Ç—ã –±–µ—Ç</a>
        <a class="chip" href="lessons.html">–°–∞–±–∞“õ—Ç–∞—Ä</a>
        <a class="chip" href="vocabulary.html">–°”©–∑–¥—ñ–∫</a>
        <a class="chip active" href="comics.html">–ö–æ–º–∏–∫—Å</a>
        <a class="chip" href="assistant.html">–ò–ò</a>
      </div>
    </nav>

    <section class="hero">
      <h2>–ö–æ–º–∏–∫—Å + —Ä–∞–Ω–¥–æ–º —Ç–∞–ø—Å—ã—Ä–º–∞</h2>
      <p class="ru">–¢”©–º–µ–Ω–¥–µ –∫–æ–º–∏–∫—Å –æ—Å—ã –±–µ—Ç—Ç–µ –∞—à—ã–ª–∞–¥—ã. ”ò—Ä –∂–∞“£–∞—Ä—Ç“õ–∞–Ω–¥–∞ —Å“±—Ä–∞“õ—Ç–∞—Ä —Ä–∞–Ω–¥–æ–º –±–æ–ª–∞–¥—ã.</p>
    </section>

    <section class="card full">
      <div class="actions">
        <button class="btn primary big" id="btnRandom" type="button">üé≤ –†–∞–Ω–¥–æ–º –∫–æ–º–∏–∫—Å</button>
        <button class="btn big" id="btnNewQ" type="button">üîÑ –ñ–∞“£–∞ —Å“±—Ä–∞“õ—Ç–∞—Ä</button>
      </div>

      <div class="smalltxt" style="margin-top:10px">
        –ï–≥–µ—Ä –∫–æ–º–∏–∫—Å –∫”©—Ä—ñ–Ω–±–µ—Å–µ ‚Äî –±“±–ª QazComics —Ç–∞—Ä–∞–ø—ã–Ω–∞–Ω iframe-“õ–∞ —Ç—ã–π—ã–º –±–æ–ª—É—ã –º“Ø–º–∫—ñ–Ω.
      </div>

      <iframe id="comicFrame"
        style="width:100%;height:720px;margin-top:12px;border:1px solid rgba(255,255,255,.12);border-radius:18px;background:rgba(0,0,0,.12)"
        loading="lazy"
        referrerpolicy="no-referrer">
      </iframe>

      <hr class="sep">

      <div class="grid">
        <div class="card full">
          <h3>–°“±—Ä–∞“õ—Ç–∞—Ä <span class="ru">/ –í–æ–ø—Ä–æ—Å—ã</span></h3>
          <div id="qBox"></div>
          <div class="actions">
            <button class="btn success big" id="btnCheck" type="button">–¢–µ–∫—Å–µ—Ä—É</button>
          </div>
          <div class="out" id="resultOut">–ù”ô—Ç–∏–∂–µ –æ—Å—ã–Ω–¥–∞ —à—ã“ì–∞–¥—ã‚Ä¶</div>
        </div>
      </div>
    </section>
  </div>

  <!-- Elfsight AI (“õ–æ—è —Å–∞–ª–∞—Ç—ã–Ω–¥–∞–π) -->
  <script src="https://elfsightcdn.com/platform.js" async></script>
  <div class="elfsight-app-5f869929-6809-4ce9-a5e5-0c39be8285c4" data-elfsight-app-lazy></div>

  <script>
    // ====== 1) –ö–æ–º–∏–∫—Å—Ç–µ—Ä —Ç—ñ–∑—ñ–º—ñ (–æ—Å—ã –∂–µ—Ä–≥–µ –∫”©–±–µ–π—Ç–µ—Å—ñ–∑) ======
    const COMICS = [
      { id:"c1", title:"QazComics 5/2", url:"https://qazcomics.kz/kz/comics/5/2" },
      { id:"c2", title:"QazComics (–±–∞—Å—Ç—ã –±–µ—Ç)", url:"https://qazcomics.kz/kz" }
      // “ö–∞–ª–∞—Å–∞“£—ã–∑: {id:"c3", title:"...", url:"https://qazcomics.kz/kz/comics/..../...."}
    ];

    // ====== 2) –°“±—Ä–∞“õ –±–∞–Ω–∫—ñ (—Ä–∞–Ω–¥–æ–º) ======
    // –ï—Å–∫–µ—Ä—Ç—É: –∫–æ–º–∏–∫—Å—Ç—ñ“£ —ñ—à–∫—ñ –º”ô—Ç—ñ–Ω—ñ–Ω –±—ñ–∑ —Å—ã—Ä—Ç“õ—ã —Å–∞–π—Ç—Ç–∞–Ω –æ“õ–∏ –∞–ª–º–∞–π–º—ã–∑ (CORS), —Å–æ–Ω–¥—ã“õ—Ç–∞–Ω —Å“±—Ä–∞“õ—Ç–∞—Ä —Ç“Ø—Å—ñ–Ω—É/–º–∞–∑–º“±–Ω–¥–∞—É —Ç–∏–ø—ñ.
    const QUESTION_POOL = [
      { type:"mcq", prompt:"–ö–æ–º–∏–∫—Å—Ç—ñ“£ –±–∞—Å—Ç—ã –∫–µ–π—ñ–ø–∫–µ—Ä—ñ –∫—ñ–º–≥–µ “±“õ—Å–∞–π–¥—ã?", options:["–û“õ—É—à—ã“ì–∞","–ú“±“ì–∞–ª—ñ–º–≥–µ","–î”ô—Ä—ñ–≥–µ—Ä–≥–µ","–ë–µ–ª–≥—ñ—Å—ñ–∑"], correctIndex:0 },
      { type:"mcq", prompt:"–û“õ–∏“ì–∞ “õ–∞–π –∂–µ—Ä–¥–µ ”©—Ç—É—ñ –º“Ø–º–∫—ñ–Ω?", options:["–ú–µ–∫—Ç–µ–ø—Ç–µ","–û—Ä–º–∞–Ω–¥–∞","“í–∞—Ä—ã—à—Ç–∞","–¢–µ“£—ñ–∑–¥–µ"], correctIndex:0 },
      { type:"mcq", prompt:"–ö–æ–º–∏–∫—Å—Ç–µ–≥—ñ –±–∞—Å—Ç—ã ”ô—Ä–µ–∫–µ—Ç “õ–∞–Ω–¥–∞–π?", options:["–ö”©–º–µ–∫ —Å“±—Ä–∞—É","“∞—Ä—ã—Å—É","“∞–π—ã“õ—Ç–∞—É","“ö–∞—à—É"], correctIndex:0 },
      { type:"text", prompt:"2 —Å”©–π–ª–µ–º–º–µ–Ω: –Ω–µ –±–æ–ª–¥—ã? (“õ—ã—Å“õ–∞ –∂–∞–∑)" },
      { type:"text", prompt:"1 —Å”©–π–ª–µ–º–º–µ–Ω: –Ω–µ–≥—ñ–∑–≥—ñ –æ–π—ã “õ–∞–Ω–¥–∞–π?" },
      { type:"text", prompt:"3 —Å”©–∑ –∂–∞–∑: –∫–æ–º–∏–∫—Å—Ç–µ–≥—ñ –µ“£ –º–∞“£—ã–∑–¥—ã —Å”©–∑–¥–µ—Ä" }
    ];

    // ====== 3) –£—Ç–∏–ª–∏—Ç–∞–ª–∞—Ä ======
    function randInt(max){ return Math.floor(Math.random()*max); }
    function pickRandom(arr){ return arr[randInt(arr.length)]; }

    function sample(arr, k){
      const copy = arr.slice();
      const out = [];
      while(out.length < k && copy.length){
        out.push(copy.splice(randInt(copy.length),1)[0]);
      }
      return out;
    }

    // ====== 4) –ö–æ–º–∏–∫—Å –∂“Ø–∫—Ç–µ—É ======
    const frame = document.getElementById("comicFrame");
    const btnRandom = document.getElementById("btnRandom");
    const btnNewQ = document.getElementById("btnNewQ");
    const qBox = document.getElementById("qBox");
    const btnCheck = document.getElementById("btnCheck");
    const resultOut = document.getElementById("resultOut");

    let currentComic = COMICS[0];
    let currentQuestions = [];

    function loadComic(comic){
      currentComic = comic;
      frame.src = comic.url; // iframe —ñ—à—ñ–Ω–¥–µ –∞—à—ã–ª–∞–¥—ã
      generateQuestions();
      resultOut.textContent = "–ù”ô—Ç–∏–∂–µ –æ—Å—ã–Ω–¥–∞ —à—ã“ì–∞–¥—ã‚Ä¶";
    }

    // ====== 5) –°“±—Ä–∞“õ—Ç–∞—Ä–¥—ã —Ä–∞–Ω–¥–æ–º –∂–∞—Å–∞—É ======
    function generateQuestions(){
      // 3 —Å“±—Ä–∞“õ —à—ã“ì–∞—Ä–∞–º—ã–∑: 2 –∂–∞–±—ã“õ (mcq) + 1 –∞—à—ã“õ (text) –∞—Ä–∞–ª–∞—Å –±–æ–ª—Å—ã–Ω
      const mcqs = QUESTION_POOL.filter(q => q.type === "mcq");
      const texts = QUESTION_POOL.filter(q => q.type === "text");

      const chosen = [];
      chosen.push(...sample(mcqs, 2));
      chosen.push(...sample(texts, 1));

      // –∞—Ä–∞–ª–∞—Å—Ç—ã—Ä—É
      for (let i = chosen.length - 1; i > 0; i--) {
        const j = randInt(i + 1);
        [chosen[i], chosen[j]] = [chosen[j], chosen[i]];
      }

      currentQuestions = chosen;
      renderQuestions();
    }

    function renderQuestions(){
      qBox.innerHTML = `
        <div class="task">
          <h4>–ö–æ–º–∏–∫—Å: ${escapeHtml(currentComic.title)}</h4>
          <div class="smalltxt">–ï—Ä–µ–∂–µ: “õ—ã—Å“õ–∞ –∂–∞—É–∞–ø. 1‚Äì2 —Å”©–π–ª–µ–º –∂–µ—Ç–∫—ñ–ª—ñ–∫—Ç—ñ.</div>
        </div>
      ` + currentQuestions.map((q, idx) => {
        if(q.type === "mcq"){
          return `
            <div class="task">
              <h4>${idx+1}) ${escapeHtml(q.prompt)}</h4>
              ${q.options.map((opt, i) => `
                <label class="opt">
                  <input type="radio" name="q_${idx}" value="${i}">
                  <span>${escapeHtml(opt)}</span>
                </label>
              `).join("")}
            </div>
          `;
        } else {
          return `
            <div class="task">
              <h4>${idx+1}) ${escapeHtml(q.prompt)}</h4>
              <textarea class="input" rows="3" id="txt_${idx}" placeholder="–ñ–∞—É–∞–±—ã“£–¥—ã –∂–∞–∑..."></textarea>
            </div>
          `;
        }
      }).join("");
    }

    // ====== 6) –¢–µ–∫—Å–µ—Ä—É (mcq “ì–∞–Ω–∞ –Ω–∞“õ—Ç—ã —Ç–µ–∫—Å–µ—Ä—ñ–ª–µ–¥—ñ, text ‚Äî ‚Äú–∂–∞–∑—ã–ª–¥—ã/–∂–∞–∑—ã–ª–º–∞–¥—ã‚Äù) ======
    function checkAnswers(){
      let score = 0;
      let total = 0;
      let notes = [];

      currentQuestions.forEach((q, idx) => {
        if(q.type === "mcq"){
          total++;
          const picked = document.querySelector(`input[name="q_${idx}"]:checked`);
          if(!picked){
            notes.push(`${idx+1}) –∂–∞—É–∞–ø —Ç–∞“£–¥–∞–ª–º–∞“ì–∞–Ω`);
            return;
          }
          if(Number(picked.value) === q.correctIndex){
            score++;
          } else {
            notes.push(`${idx+1}) “õ–∞—Ç–µ (–¥“±—Ä—ã—Å—ã: ${q.options[q.correctIndex]})`);
          }
        } else {
          // text: –±–∞—Ä/–∂–æ“õ –¥–µ–ø –±–µ–ª–≥—ñ–ª–µ–π–º—ñ–∑
          const v = (document.getElementById(`txt_${idx}`)?.value || "").trim();
          if(!v) notes.push(`${idx+1}) –º”ô—Ç—ñ–Ω–¥—ñ–∫ –∂–∞—É–∞–ø –∂–æ“õ`);
        }
      });

      let msg = `–ö–æ–º–∏–∫—Å: ${currentComic.title}\n`;
      msg += `MCQ –Ω”ô—Ç–∏–∂–µ: ${score}/${total}\n`;
      if(notes.length) msg += `–ï—Å–∫–µ—Ä—Ç—É:\n- ` + notes.join("\n- ");
      else msg += `–ñ–∞“õ—Å—ã! –ë–∞—Ä–ª—ã“ì—ã –æ—Ä—ã–Ω–¥–∞–ª–¥—ã.`;

      resultOut.textContent = msg;
    }

    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
    }

    // ====== 7) –ë–∞—Ç—ã—Ä–º–∞–ª–∞—Ä ======
    btnRandom.addEventListener("click", () => loadComic(pickRandom(COMICS)));
    btnNewQ.addEventListener("click", () => { generateQuestions(); resultOut.textContent = "–ù”ô—Ç–∏–∂–µ –æ—Å—ã–Ω–¥–∞ —à—ã“ì–∞–¥—ã‚Ä¶"; });
    btnCheck.addEventListener("click", checkAnswers);

    // ====== 8) –ê–ª“ì–∞—à“õ—ã –∂“Ø–∫—Ç–µ—É ======
    loadComic(pickRandom(COMICS));
  </script>
</body>
</html>
